/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojo.hash"]){dojo._hasResource["dojo.hash"]=true;dojo.provide("dojo.hash");(function(){dojo.hash=function $DBHJ_(_1,_2){if(!arguments.length){return _getHash();}if(_1.charAt(0)=="#"){_1=_1.substring(1);}if(_2){_replace(_1);}else{location.href="#"+_1;}return _1;};var _3=null,_4=null,_5=dojo.config.hashPollFrequency||100;function _getHash(){var h=location.href,i=h.indexOf("#");return (i>=0)?h.substring(i+1):"";};function _dispatchEvent(){dojo.publish("/dojo/hashchange",[_getHash()]);};function _pollLocation(){if(_getHash()===_3){return;}_3=_getHash();_dispatchEvent();};function _replace(_6){if(_4){if(_4.isTransitioning()){setTimeout(dojo.hitch(null,_replace,_6),_5);return;}var _7=_4.iframe.location.href;var _8=_7.indexOf("?");_4.iframe.location.replace(_7.substring(0,_8)+"?"+_6);return;}location.replace("#"+_6);_pollLocation();};function IEUriMonitor(){var _9=document.createElement("iframe"),_a="dojo-hash-iframe",_b=dojo.config.dojoBlankHtmlUrl||dojo.moduleUrl("dojo","resources/blank.html");_9.id=_a;_9.src=_b+"?"+_getHash();_9.style.display="none";document.body.appendChild(_9);this.iframe=dojo.global[_a];var _c,_d,_e,_f,_10,_11=this.iframe.location,_12=dojo.global.location;function resetState(){_3=_12.hash;_c=_10?_3:_11.search;_d=false;_e=null;};this.isTransitioning=function $DBHH_(){return _d;};this.pollLocation=function $DBHI_(){if(!_10){try{_11.search;if(document.title!=_f){_f=this.iframe.document.title=document.title;}}catch(e){_10=true;console.error("dojo.hash: Error adding history entry. Server unreachable.");}}if(_d&&_3===_12.hash){if(_10||_11.search===_e){resetState();_dispatchEvent();}else{setTimeout(dojo.hitch(this,this.pollLocation),0);return;}}else{if(_3===_12.hash&&(_10||_c===_11.search)){}else{if(_3!==_12.hash){_3=_12.hash;_d=true;_e="?"+_getHash();_9.src=_b+_e;_10=false;setTimeout(dojo.hitch(this,this.pollLocation),0);return;}else{if(!_10){_12.href="#"+_11.search.substring(1);resetState();_dispatchEvent();}}}}setTimeout(dojo.hitch(this,this.pollLocation),_5);};resetState();setTimeout(dojo.hitch(this,this.pollLocation),_5);};dojo.addOnLoad(function(){if("onhashchange" in dojo.global&&(!dojo.isIE||(dojo.isIE>=8&&document.compatMode!="BackCompat"))){dojo.connect(dojo.global,"onhashchange",_dispatchEvent);}else{if(document.addEventListener){_3=_getHash();setInterval(_pollLocation,_5);}else{if(document.attachEvent){_4=new IEUriMonitor();}}}});})();}