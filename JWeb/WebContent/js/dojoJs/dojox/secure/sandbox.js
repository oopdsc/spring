/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojox.secure.sandbox"]){dojo._hasResource["dojox.secure.sandbox"]=true;dojo.provide("dojox.secure.sandbox");dojo.require("dojox.secure.DOM");dojo.require("dojox.secure.capability");dojo.require("dojo.NodeList-fx");(function(){var _1=setTimeout;var _2=setInterval;if({}.__proto__){var _3=function(_4){var _5=Array.prototype[_4];if(_5&&!_5.fixed){(Array.prototype[_4]=function(){if(this==window){throw new TypeError("Called with wrong this");}return _5.apply(this,arguments);}).fixed=true;}};_3("concat");_3("reverse");_3("sort");_3("slice");_3("forEach");_3("filter");_3("reduce");_3("reduceRight");_3("every");_3("map");_3("some");}var _6=function(){return dojo.xhrGet.apply(dojo,arguments);};dojox.secure.sandbox=function $DArJ_(_7){var _8=dojox.secure.DOM(_7);_7=_8(_7);var _9=_7.ownerDocument;var _a,_b=dojox.secure._safeDojoFunctions(_7,_8);var _c=[];var _d=["isNaN","isFinite","parseInt","parseFloat","escape","unescape","encodeURI","encodeURIComponent","decodeURI","decodeURIComponent","alert","confirm","prompt","Error","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","Date","RegExp","Number","Object","Array","String","Math","setTimeout","setInterval","clearTimeout","clearInterval","dojo","get","set","forEach","load","evaluate"];for(var i in _b){_d.push(i);_c.push("var "+i+"=dojo."+i);}eval(_c.join(";"));function get(_e,_f){_f=""+_f;if(dojox.secure.badProps.test(_f)){throw new Error("bad property access");}if(_e.__get__){return _e.__get__(_f);}return _e[_f];};function set(obj,_10,_11){_10=""+_10;get(obj,_10);if(obj.__set){return obj.__set(_10);}obj[_10]=_11;return _11;};function forEach(obj,fun){if(typeof fun!="function"){throw new TypeError();}if("length" in obj){if(obj.__get__){var len=obj.__get__("length");for(var i=0;i<len;i++){if(i in obj){fun.call(obj,obj.__get__(i),i,obj);}}}else{len=obj.length;for(i=0;i<len;i++){if(i in obj){fun.call(obj,obj[i],i,obj);}}}}else{for(i in obj){fun.call(obj,get(obj,i),i,obj);}}};function Class(_12,_13,_14){var _15,_16,_17;var arg;for(var i=0,l=arguments.length;typeof (arg=arguments[i])=="function"&&i<l;i++){if(_15){_a(_15,arg.prototype);}else{_16=arg;var F=function(){};F.prototype=arg.prototype;_15=new F;}}if(arg){for(var j in arg){var _18=arg[j];if(typeof _18=="function"){arg[j]=function(){if(this instanceof Class){return arguments.callee.__rawMethod__.apply(this,arguments);}throw new Error("Method called on wrong object");};arg[j].__rawMethod__=_18;}}if(arg.hasOwnProperty("constructor")){_17=arg.constructor;}}_15=_15?_a(_15,arg):arg;function Class(){if(_16){_16.apply(this,arguments);}if(_17){_17.apply(this,arguments);}};_a(Class,arguments[i]);_15.constructor=Class;Class.prototype=_15;return Class;};function checkString(_19){if(typeof _19!="function"){throw new Error("String is not allowed in setTimeout/setInterval");}};function setTimeout(_1a,_1b){checkString(_1a);return _1(_1a,_1b);};function setInterval(_1c,_1d){checkString(_1c);return _2(_1c,_1d);};function evaluate(_1e){return _8.evaluate(_1e);};var _1f=_8.load=function(url){if(url.match(/^[\w\s]*:/)){throw new Error("Access denied to cross-site requests");}return _6({url:(new _b._Url(_8.rootUrl,url))+"",secure:true});};_8.evaluate=function $DArK_(_20){dojox.secure.capability.validate(_20,_d,{document:1,element:1});if(_20.match(/^\s*[\[\{]/)){var _21=eval("("+_20+")");}else{eval(_20);}};return {loadJS:function $DArB_(url){_8.rootUrl=url;return _6({url:url,secure:true}).addCallback(function(_22){evaluate(_22,_7);});},loadHTML:function $DArC_(url){_8.rootUrl=url;return _6({url:url,secure:true}).addCallback(function(_23){_7.innerHTML=_23;});},evaluate:function $DArD_(_24){return _8.evaluate(_24);}};};})();dojox.secure._safeDojoFunctions=function $DArL_(_25,_26){var _27=["mixin","require","isString","isArray","isFunction","isObject","isArrayLike","isAlien","hitch","delegate","partial","trim","disconnect","subscribe","unsubscribe","Deferred","toJson","style","attr"];var doc=_25.ownerDocument;var _28=dojox.secure.unwrap;dojo.NodeList.prototype.addContent.safetyCheck=function $DArM_(_29){_26.safeHTML(_29);};dojo.NodeList.prototype.style.safetyCheck=function $DArN_(_2a,_2b){if(_2a=="behavior"){throw new Error("Can not set behavior");}_26.safeCSS(_2b);};dojo.NodeList.prototype.attr.safetyCheck=function $DArO_(_2c,_2d){if(_2d&&(_2c=="src"||_2c=="href"||_2c=="style")){throw new Error("Illegal to set "+_2c);}};var _2e={query:function $DArE_(_2f,_30){return _26(dojo.query(_2f,_28(_30||_25)));},connect:function $DArF_(el,_31){var obj=el;arguments[0]=_28(el);if(obj!=arguments[0]&&_31.substring(0,2)!="on"){throw new Error("Invalid event name for element");}return dojo.connect.apply(dojo,arguments);},body:function $DArG_(){return _25;},byId:function $DArH_(id){return _25.ownerDocument.getElementById(id);},fromJson:function $DArI_(str){dojox.secure.capability.validate(str,[],{});return dojo.fromJson(str);}};for(var i=0;i<_27.length;i++){_2e[_27[i]]=dojo[_27[i]];}return _2e;};}