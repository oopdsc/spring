/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojox.secure.capability"]){dojo._hasResource["dojox.secure.capability"]=true;dojo.provide("dojox.secure.capability");dojox.secure.badProps=/^__|^(apply|call|callee|caller|constructor|eval|prototype|this|unwatch|valueOf|watch)$|__$/;dojox.secure.capability={keywords:["break","case","catch","const","continue","debugger","default","delete","do","else","enum","false","finally","for","function","if","in","instanceof","new","null","yield","return","switch","throw","true","try","typeof","var","void","while"],validate:function $DAq1_(_1,_2,_3){var _4=this.keywords;for(var i=0;i<_4.length;i++){_3[_4[i]]=true;}var _5="|this| keyword in object literal without a Class call";var _6=[];if(_1.match(/[\u200c-\u200f\u202a-\u202e\u206a-\u206f\uff00-\uffff]/)){throw new Error("Illegal unicode characters detected");}if(_1.match(/\/\*@cc_on/)){throw new Error("Conditional compilation token is not allowed");}_1=_1.replace(/\\["'\\\/bfnrtu]/g,"@").replace(/\/\/.*|\/\*[\w\W]*?\*\/|\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*|("[^"]*")|('[^']*')/g,function(t){return t.match(/^\/\/|^\/\*/)?" ":"0";}).replace(/\.\s*([a-z\$_A-Z][\w\$_]*)|([;,{])\s*([a-z\$_A-Z][\w\$_]*\s*):/g,function(t,_7,_8,_9){_7=_7||_9;if(/^__|^(apply|call|callee|caller|constructor|eval|prototype|this|unwatch|valueOf|watch)$|__$/.test(_7)){throw new Error("Illegal property name "+_7);}return (_8&&(_8+"0:"))||"~";});_1.replace(/([^\[][\]\}]\s*=)|((\Wreturn|\S)\s*\[\s*\+?)|([^=!][=!]=[^=])/g,function(_a){if(!_a.match(/((\Wreturn|[=\&\|\:\?\,])\s*\[)|\[\s*\+$/)){throw new Error("Illegal operator "+_a.substring(1));}});_1=_1.replace(new RegExp("("+_2.join("|")+")[\\s~]*\\(","g"),function(_b){return "new(";});function findOuterRefs(_c,_d){var _e={};_c.replace(/#\d+/g,function(b){var _f=_6[b.substring(1)];for(var i in _f){if(i==_5){throw i;}if(i=="this"&&_f[":method"]&&_f["this"]==1){i=_5;}if(i!=":method"){_e[i]=2;}}});_c.replace(/(\W|^)([a-z_\$A-Z][\w_\$]*)/g,function(t,a,_10){if(_10.charAt(0)=="_"){throw new Error("Names may not start with _");}_e[_10]=1;});return _e;};var _11,_12;function parseBlock(t,_13,a,b,_14,_15){_15.replace(/(^|,)0:\s*function#(\d+)/g,function(t,a,b){var _16=_6[b];_16[":method"]=1;});_15=_15.replace(/(^|[^_\w\$])Class\s*\(\s*([_\w\$]+\s*,\s*)*#(\d+)/g,function(t,p,a,b){var _17=_6[b];delete _17[_5];return (p||"")+(a||"")+"#"+b;});_12=findOuterRefs(_15,_13);function parseVars(t,a,b,_18){_18.replace(/,?([a-z\$A-Z][_\w\$]*)/g,function(t,_19){if(_19=="Class"){throw new Error("Class is reserved");}delete _12[_19];});};if(_13){parseVars(t,a,a,_14);}_15.replace(/(\W|^)(var) ([ \t,_\w\$]+)/g,parseVars);return (a||"")+(b||"")+"#"+(_6.push(_12)-1);};do{_11=_1.replace(/((function|catch)(\s+[_\w\$]+)?\s*\(([^\)]*)\)\s*)?{([^{}]*)}/g,parseBlock);}while(_11!=_1&&(_1=_11));parseBlock(0,0,0,0,0,_1);for(i in _12){if(!(i in _3)){throw new Error("Illegal reference to "+i);}}}};}