/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojox.io.xhrPlugins"]){dojo._hasResource["dojox.io.xhrPlugins"]=true;dojo.provide("dojox.io.xhrPlugins");dojo.require("dojo.AdapterRegistry");dojo.require("dojo._base.xhr");(function(){var _1;var _2;function getPlainXhr(){return _2=dojox.io.xhrPlugins.plainXhr=_2||dojo._defaultXhr||dojo.xhr;};dojox.io.xhrPlugins.register=function $DAjF_(){var _3=getPlainXhr();if(!_1){_1=new dojo.AdapterRegistry();dojo[dojo._defaultXhr?"_defaultXhr":"xhr"]=function(_4,_5,_6){return _1.match.apply(_1,arguments);};_1.register("xhr",function(_7,_8){if(!_8.url.match(/^\w*:\/\//)){return true;}var _9=window.location.href.match(/^.*?\/\/.*?\//)[0];return _8.url.substring(0,_9.length)==_9;},_3);}return _1.register.apply(_1,arguments);};dojox.io.xhrPlugins.addProxy=function $DAjG_(_a){var _b=getPlainXhr();dojox.io.xhrPlugins.register("proxy",function(_c,_d){return true;},function(_e,_f,_10){_f.url=_a+encodeURIComponent(_f.url);return _b.call(dojo,_e,_f,_10);});};var _11;dojox.io.xhrPlugins.addCrossSiteXhr=function $DAjH_(url,_12){var _13=getPlainXhr();if(_11===undefined&&window.XMLHttpRequest){try{var xhr=new XMLHttpRequest();xhr.open("GET","http://testing-cross-domain-capability.com",true);_11=true;dojo.config.noRequestedWithHeaders=true;}catch(e){_11=false;}}dojox.io.xhrPlugins.register("cs-xhr",function(_14,_15){return (_11||(window.XDomainRequest&&_15.sync!==true&&(_14=="GET"||_14=="POST"||_12)))&&(_15.url.substring(0,url.length)==url);},_11?_13:function(){var _16=dojo._xhrObj;dojo._xhrObj=function $DAjI_(){var xdr=new XDomainRequest();xdr.readyState=1;xdr.setRequestHeader=function $DAjJ_(){};xdr.getResponseHeader=function $DAjK_(_17){return _17=="Content-Type"?xdr.contentType:null;};function handler(_18,_19){return function(){xdr.readyState=_19;xdr.status=_18;};};xdr.onload=handler(200,4);xdr.onprogress=handler(200,3);xdr.onerror=handler(404,4);return xdr;};var dfd=(_12?_12(getPlainXhr()):getPlainXhr()).apply(dojo,arguments);dojo._xhrObj=_16;return dfd;});};dojox.io.xhrPlugins.fullHttpAdapter=function $DAjL_(_1a,_1b){return function(_1c,_1d,_1e){var _1f={};var _20={};if(_1c!="GET"){_20["http-method"]=_1c;if(_1d.putData&&_1b){_1f["http-content"]=_1d.putData;delete _1d.putData;_1e=false;}if(_1d.postData&&_1b){_1f["http-content"]=_1d.postData;delete _1d.postData;_1e=false;}_1c="POST";}for(var i in _1d.headers){var _21=i.match(/^X-/)?i.substring(2).replace(/-/g,"_").toLowerCase():("http-"+i);_20[_21]=_1d.headers[i];}_1d.query=dojo.objectToQuery(_20);dojo._ioAddQueryToUrl(_1d);_1d.content=dojo.mixin(_1d.content||{},_1f);return _1a.call(dojo,_1c,_1d,_1e);};};})();}