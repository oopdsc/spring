/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojox.editor.plugins.TablePlugins"]){dojo._hasResource["dojox.editor.plugins.TablePlugins"]=true;dojo.provide("dojox.editor.plugins.TablePlugins");dojo.require("dijit._editor._Plugin");dojo.require("dijit._editor.selection");dojo.require("dijit.Menu");dojo.require("dojo.i18n");dojo.requireLocalization("dojox.editor.plugins","TableDialog",null,"ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw");dojo.experimental("dojox.editor.plugins.TablePlugins");dojo.declare("dojox.editor.plugins.GlobalTableHandler",dijit._editor._Plugin,{tablesConnected:false,currentlyAvailable:false,alwaysAvailable:false,availableCurrentlySet:false,initialized:false,tableData:null,shiftKeyDown:false,editorDomNode:null,undoEnabled:dojo.isIE,doMixins:function $D72_(){dojo.mixin(this.editor,{getAncestorElement:function $D73_(_1){return dojo.withGlobal(this.window,"getAncestorElement",dijit._editor.selection,[_1]);},hasAncestorElement:function $D74_(_2){return true;return dojo.withGlobal(this.window,"hasAncestorElement",dijit._editor.selection,[_2]);},selectElement:function $D75_(_3){dojo.withGlobal(this.window,"selectElement",dijit._editor.selection,[_3]);},byId:function $D76_(id){return dojo.withGlobal(this.window,"byId",dojo,[id]);},query:function $D77_(_4,_5,_6){var ar=dojo.withGlobal(this.window,"query",dojo,[_4,_5]);return (_6)?ar[0]:ar;}});},initialize:function $D78_(_7){if(this.initialized){return;}this.initialized=true;this.editor=_7;_7.onLoadDeferred.addCallback(dojo.hitch(this,function(){this.editorDomNode=this.editor.editNode||this.editor.iframe.document.body.firstChild;dojo.connect(this.editorDomNode,"mouseup",this.editor,"onClick");dojo.connect(this.editor,"onDisplayChanged",this,"checkAvailable");this.doMixins();this.connectDraggable();}));},getTableInfo:function $D79_(_8){if(_8){this._tempStoreTableData(false);}if(this.tableData){console.log("returning current tableData:",this.tableData);return this.tableData;}var tr,_9,td,_a,_b,_c,_d,_e;td=this.editor.getAncestorElement("td");if(td){tr=td.parentNode;}_b=this.editor.getAncestorElement("table");_a=dojo.query("td",_b);_a.forEach(function(d,i){if(td==d){_d=i;}});_9=dojo.query("tr",_b);_9.forEach(function(r,i){if(tr==r){_e=i;}});_c=_a.length/_9.length;var o={tbl:_b,td:td,tr:tr,trs:_9,tds:_a,rows:_9.length,cols:_c,tdIndex:_d,trIndex:_e,colIndex:_d%_c};console.log("NEW tableData:",o);this.tableData=o;this._tempStoreTableData(500);return this.tableData;},connectDraggable:function $D8A_(){if(!dojo.isIE){return;}this.editorDomNode.ondragstart=dojo.hitch(this,"onDragStart");this.editorDomNode.ondragend=dojo.hitch(this,"onDragEnd");},onDragStart:function $D8B_(){var e=window.event;if(!e.srcElement.id){e.srcElement.id="tbl_"+(new Date().getTime());}},onDragEnd:function $D8C_(){var e=window.event;var _f=e.srcElement;var id=_f.id;var win=this.editor.window;if(_f.tagName.toLowerCase()=="table"){setTimeout(function(){var _10=dojo.withGlobal(win,"byId",dojo,[id]);dojo.removeAttr(_10,"align");},100);}},checkAvailable:function $D8D_(){if(this.availableCurrentlySet){return this.currentlyAvailable;}if(!this.editor){return false;}if(this.alwaysAvailable){return true;}this.currentlyAvailable=this.editor.hasAncestorElement("table");if(this.currentlyAvailable){this.connectTableKeys();}else{this.disconnectTableKeys();}this._tempAvailability(500);dojo.publish("available",[this.currentlyAvailable]);return this.currentlyAvailable;},_prepareTable:function $D8E_(tbl){var tds=this.editor.query("td",tbl);console.log("prep:",tds,tbl);if(!tds[0].id){tds.forEach(function(td,i){if(!td.id){td.id="tdid"+i+this.getTimeStamp();}},this);}return tds;},getTimeStamp:function $D8F_(){return Math.floor(new Date().getTime()*1e-8);},_tempStoreTableData:function $D8G_(_11){if(_11===true){}else{if(_11===false){this.tableData=null;}else{if(_11===undefined){console.warn("_tempStoreTableData must be passed an argument");}else{setTimeout(dojo.hitch(this,function(){this.tableData=null;}),_11);}}}},_tempAvailability:function $D8H_(_12){if(_12===true){this.availableCurrentlySet=true;}else{if(_12===false){this.availableCurrentlySet=false;}else{if(_12===undefined){console.warn("_tempAvailability must be passed an argument");}else{this.availableCurrentlySet=true;setTimeout(dojo.hitch(this,function(){this.availableCurrentlySet=false;}),_12);}}}},connectTableKeys:function $D8I_(){if(this.tablesConnected){return;}this.tablesConnected=true;var _13=(this.editor.iframe)?this.editor.document:this.editor.editNode;this.cnKeyDn=dojo.connect(_13,"onkeydown",this,"onKeyDown");this.cnKeyUp=dojo.connect(_13,"onkeyup",this,"onKeyUp");dojo.connect(_13,"onkeypress",this,"onKeyUp");},disconnectTableKeys:function $D8J_(){dojo.disconnect(this.cnKeyDn);dojo.disconnect(this.cnKeyUp);this.tablesConnected=false;},onKeyDown:function $D8K_(evt){var key=evt.keyCode;if(key==16){this.shiftKeyDown=true;}if(key==9){console.log("TAB!:");var o=this.getTableInfo();o.tdIndex=(this.shiftKeyDown)?o.tdIndex-1:tabTo=o.tdIndex+1;if(o.tdIndex>=0&&o.tdIndex<o.tds.length){this.editor.selectElement(o.tds[o.tdIndex]);this.currentlyAvailable=true;this._tempAvailability(true);this._tempStoreTableData(true);this.stopEvent=true;}else{this.stopEvent=false;this.onDisplayChanged();}if(this.stopEvent){dojo.stopEvent(evt);}}},onKeyUp:function $D8L_(evt){var key=evt.keyCode;if(key==16){this.shiftKeyDown=false;}if(key==37||key==38||key==39||key==40){this.onDisplayChanged();}if(key==9&&this.stopEvent){dojo.stopEvent(evt);}},onDisplayChanged:function $D8M_(){this.currentlyAvailable=false;this._tempStoreTableData(false);this._tempAvailability(false);this.checkAvailable();}});tablePluginHandler=new dojox.editor.plugins.GlobalTableHandler();dojo.declare("dojox.editor.plugins.TablePlugins",dijit._editor._Plugin,{iconClassPrefix:"editorIcon",useDefaultCommand:false,buttonClass:dijit.form.Button,commandName:"",label:"",alwaysAvailable:false,undoEnabled:false,constructor:function $D8N_(){switch(this.commandName){case "colorTableCell":this.buttonClass=dijit.form.DropDownButton;this.dropDown=new dijit.ColorPalette();this.connect(this.dropDown,"onChange",function(_14){this.modTable(null,_14);});break;case "modifyTable":this.buttonClass=dijit.form.Button;this.modTable=this.launchModifyDialog;break;case "insertTable":this.alwaysAvailable=true;this.buttonClass=dijit.form.Button;this.modTable=this.launchInsertDialog;break;case "tableContextMenu":this.connect(this,"setEditor",function(_15){_15.onLoadDeferred.addCallback(dojo.hitch(this,function(){this._createContextMenu();}));this.button.domNode.style.display="none";});break;}dojo.subscribe("available",this,"onDisplayChanged");},onDisplayChanged:function $D8O_(_16){if(!this.alwaysAvailable){this.available=_16;this.button.attr("disabled",!this.available);}},setEditor:function $D8P_(){this.inherited(arguments);this.onEditorLoaded();},onEditorLoaded:function $D8Q_(){tablePluginHandler.initialize(this.editor);},_createContextMenu:function $D8R_(){var _17=dojo.isMoz?this.editor.editNode:this.editorDomNode;var _18=new dijit.Menu({targetNodeIds:[_17],id:"progMenu",contextMenuForWindow:dojo.isIE});var _19=dijit.MenuItem;var _1a=dojo.i18n.getLocalization("dojox.editor.plugins","TableDialog",this.lang);_18.addChild(new _19({label:_1a.selectTableLabel,onClick:dojo.hitch(this,"selectTable")}));_18.addChild(new dijit.MenuSeparator());_18.addChild(new _19({label:_1a.insertTableRowBeforeLabel,onClick:dojo.hitch(this,"modTable","insertTableRowBefore")}));_18.addChild(new _19({label:_1a.insertTableRowAfterLabel,onClick:dojo.hitch(this,"modTable","insertTableRowAfter")}));_18.addChild(new _19({label:_1a.insertTableColumnBeforeLabel,onClick:dojo.hitch(this,"modTable","insertTableColumnBefore")}));_18.addChild(new _19({label:_1a.insertTableColumnAfterLabel,onClick:dojo.hitch(this,"modTable","insertTableColumnAfter")}));_18.addChild(new dijit.MenuSeparator());_18.addChild(new _19({label:_1a.deleteTableRowLabel,onClick:dojo.hitch(this,"modTable","deleteTableRow")}));_18.addChild(new _19({label:_1a.deleteTableColumnLabel,onClick:dojo.hitch(this,"modTable","deleteTableColumn")}));_18._openMyself=function $D8q_(e){if(!tablePluginHandler.checkAvailable()){return;}if(this.leftClickToOpen&&e.button>0){return;}dojo.stopEvent(e);var x,y;if(dojo.isIE){x=e.x;y=e.y;}else{x=e.screenX;y=e.screenY+25;}var _1b=this;var _1c=dijit.getFocus(this);function closeAndRestoreFocus(){dijit.focus(_1c);dijit.popup.close(_1b);};var res=dijit.popup.open({popup:this,x:x,y:y,onExecute:closeAndRestoreFocus,onCancel:closeAndRestoreFocus,orient:this.isLeftToRight()?"L":"R"});var v=dijit.getViewport();if(res.y+res.h>v.h){if(e.screenY-res.h>=0){y=e.screenY-res.h;}else{y=0;}dijit.popup.close(this);res=dijit.popup.open({popup:this,x:x,y:y,onExecute:closeAndRestoreFocus,onCancel:closeAndRestoreFocus,orient:this.isLeftToRight()?"L":"R"});}console.log(dijit.getViewport());this.focus();this._onBlur=function $D8n_(){this.inherited("_onBlur",arguments);dijit.popup.close(this);};};this.menu=_18;},selectTable:function $D8S_(){var o=this.getTableInfo();dojo.withGlobal(this.editor.window,"selectElement",dijit._editor.selection,[o.tbl]);},launchInsertDialog:function $D8T_(){var w=new dojox.editor.plugins.EditorTableDialog({});w.show();var c=dojo.connect(w,"onBuildTable",this,function(obj){dojo.disconnect(c);var res=this.editor.execCommand("inserthtml",obj.htmlText);});},launchModifyDialog:function $D8U_(){var o=this.getTableInfo();console.log("LAUNCH DIALOG");var w=new dojox.editor.plugins.EditorModifyTableDialog({table:o.tbl});w.show();this.connect(w,"onSetTable",function(_1d){var o=this.getTableInfo();console.log("set color:",_1d);dojo.attr(o.td,"bgcolor",_1d);});},_initButton:function $D8V_(){this.command=this.commandName;this.label=this.editor.commands[this.command]=this._makeTitle(this.command);this.inherited(arguments);delete this.command;if(this.commandName!="colorTableCell"){this.connect(this.button.domNode,"click","modTable");}if(this.commandName=="tableContextMenu"){this.button.domNode.display="none";}this.onDisplayChanged(false);},modTable:function $D8W_(cmd,_1e){this.begEdit();var o=this.getTableInfo();var sw=(dojo.isString(cmd))?cmd:this.commandName;var r,c,i;var _1f=false;switch(sw){case "insertTableRowBefore":r=o.tbl.insertRow(o.trIndex);for(i=0;i<o.cols;i++){c=r.insertCell(-1);c.innerHTML="&nbsp;";}break;case "insertTableRowAfter":r=o.tbl.insertRow(o.trIndex+1);for(i=0;i<o.cols;i++){c=r.insertCell(-1);c.innerHTML="&nbsp;";}break;case "insertTableColumnBefore":o.trs.forEach(function(r){c=r.insertCell(o.colIndex);c.innerHTML="&nbsp;";});_1f=true;break;case "insertTableColumnAfter":o.trs.forEach(function(r){c=r.insertCell(o.colIndex+1);c.innerHTML="&nbsp;";});_1f=true;break;case "deleteTableRow":o.tbl.deleteRow(o.trIndex);console.log("TableInfo:",this.getTableInfo());break;case "deleteTableColumn":o.trs.forEach(function(tr){tr.deleteCell(o.colIndex);});_1f=true;break;case "colorTableCell":var tds=this.getSelectedCells(o.tbl);dojo.forEach(tds,function(td){dojo.style(td,"backgroundColor",_1e);});break;case "modifyTable":break;case "insertTable":break;}if(_1f){this.makeColumnsEven();}this.endEdit();},begEdit:function $D8X_(){if(tablePluginHandler.undoEnabled){console.log("UNDO:",this.editor.customUndo);if(this.editor.customUndo){this.editor.beginEditing();}else{this.valBeforeUndo=this.editor.getValue();console.log("VAL:",this.valBeforeUndo);}}},endEdit:function $D8Y_(){if(tablePluginHandler.undoEnabled){if(this.editor.customUndo){this.editor.endEditing();}else{var _20=this.editor.getValue();this.editor.setValue(this.valBeforeUndo);this.editor.replaceValue(_20);}this.editor.onDisplayChanged();}},makeColumnsEven:function $D8Z_(){setTimeout(dojo.hitch(this,function(){var o=this.getTableInfo(true);var w=Math.floor(100/o.cols);o.tds.forEach(function(d){dojo.attr(d,"width",w+"%");});}),10);},getTableInfo:function $D8a_(_21){return tablePluginHandler.getTableInfo(_21);},_makeTitle:function $D8b_(str){var s=str.split(""),ns=[];dojo.forEach(str,function(c,i){if(c.charCodeAt(0)<91&&i>0&&ns[i-1].charCodeAt(0)!=32){ns.push(" ");}if(i==0){c=c.toUpperCase();}ns.push(c);});return ns.join("");},getSelectedCells:function $D8c_(){var _22=[];var tbl=this.getTableInfo().tbl;var tds=tablePluginHandler._prepareTable(tbl);var e=this.editor;var r;if(!dojo.isIE){r=dijit.range.getSelection(e.window);var _23=false;var _24=false;if(r.anchorNode&&r.anchorNode.tagName&&r.anchorNode.tagName.toLowerCase()=="tr"){var trs=dojo.query("tr",tbl);var _25=[];trs.forEach(function(tr,i){if(!_23&&(tr==r.anchorNode||tr==r.focusNode)){_25.push(tr);_23=true;if(r.anchorNode==r.focusNode){_24=true;}}else{if(_23&&!_24){_25.push(tr);if(tr==r.anchorNode||tr==r.focusNode){_24=true;}}}});dojo.forEach(_25,function(tr){_22=_22.concat(dojo.query("td",tr));},this);}else{tds.forEach(function(td,i){if(!_23&&(td.id==r.anchorNode.parentNode.id||td.id==r.focusNode.parentNode.id)){_22.push(td);_23=true;if(r.anchorNode.parentNode.id==r.focusNode.parentNode.id){_24=true;}}else{if(_23&&!_24){_22.push(td);if(td.id==r.focusNode.parentNode.id||td.id==r.anchorNode.parentNode.id){_24=true;}}}});console.log("SAF CELLS:",_22);}}if(dojo.isIE){r=document.selection.createRange();var str=r.htmlText.match(/id=\w*/g);dojo.forEach(str,function(a){var id=a.substring(3,a.length);_22.push(e.byId(id));},this);}return _22;}});dojo.provide("dojox.editor.plugins.EditorTableDialog");dojo.require("dijit.Dialog");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.Button");dojo.declare("dojox.editor.plugins.EditorTableDialog",[dijit.Dialog],{baseClass:"EditorTableDialog",widgetsInTemplate:true,templateString:dojo.cache("dojox.editor.plugins","resources/insertTable.html","<div class=\"dijitDialog\" tabindex=\"-1\" waiRole=\"dialog\" waiState=\"labelledby-${id}_title\">\r\n\t<div dojoAttachPoint=\"titleBar\" class=\"dijitDialogTitleBar\">\r\n\t<span dojoAttachPoint=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\">${insertTableTitle}</span>\r\n\t<span dojoAttachPoint=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" dojoAttachEvent=\"onclick: onCancel\" title=\"${buttonCancel}\">\r\n\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\r\n\t</span>\r\n\t</div>\r\n    <div dojoAttachPoint=\"containerNode\" class=\"dijitDialogPaneContent\">\r\n        <table class=\"etdTable\"><tr>\r\n            <td class=\"left\">\r\n                <span dojoAttachPoint=\"selectRow\" dojoType=\"dijit.form.TextBox\" value=\"2\"></span>\r\n                <label>${rows}</label>\r\n            </td><td class=\"right\">\r\n                <span dojoAttachPoint=\"selectCol\" dojoType=\"dijit.form.TextBox\" value=\"2\"></span>\r\n                <label>${columns}</label>\r\n            </td></tr><tr><td>\r\n                <span dojoAttachPoint=\"selectWidth\" dojoType=\"dijit.form.TextBox\" value=\"100\"></span>\r\n                <label>${tableWidth}</label>\r\n            </td><td>\r\n                <select dojoAttachPoint=\"selectWidthType\" hasDownArrow=\"true\" dojoType=\"dijit.form.FilteringSelect\">\r\n                  <option value=\"percent\">${percent}</option>\r\n                  <option value=\"pixels\">${pixels}</option>\r\n                </select></td></tr>\r\n          <tr><td>\r\n                <span dojoAttachPoint=\"selectBorder\" dojoType=\"dijit.form.TextBox\" value=\"1\"></span>\r\n                <label>${borderThickness}</label></td>\r\n            <td>\r\n                ${pixels}\r\n            </td></tr><tr><td>\r\n                <span dojoAttachPoint=\"selectPad\" dojoType=\"dijit.form.TextBox\" value=\"0\"></span>\r\n                <label>${cellPadding}</label></td>\r\n            <td class=\"cellpad\"></td></tr><tr><td>\r\n                <span dojoAttachPoint=\"selectSpace\" dojoType=\"dijit.form.TextBox\" value=\"0\"></span>\r\n                <label>${cellSpacing}</label>\r\n            </td><td class=\"cellspace\"></td></tr></table>\r\n        <div class=\"dialogButtonContainer\">\r\n            <div dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick: onInsert\">${buttonInsert}</div>\r\n            <div dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick: onCancel\">${buttonCancel}</div>\r\n        </div>\r\n\t</div>\r\n</div>\r\n"),postMixInProperties:function $D8d_(){var _26=dojo.i18n.getLocalization("dojox.editor.plugins","TableDialog",this.lang);dojo.mixin(this,_26);this.inherited(arguments);},postCreate:function $D8e_(){dojo.addClass(this.domNode,this.baseClass);this.inherited(arguments);},onInsert:function $D8f_(){console.log("insert");var _27=this.selectRow.attr("value")||1,_28=this.selectCol.attr("value")||1,_29=this.selectWidth.attr("value"),_2a=this.selectWidthType.attr("value"),_2b=this.selectBorder.attr("value"),pad=this.selectPad.attr("value"),_2c=this.selectSpace.attr("value"),_2d="tbl_"+(new Date().getTime()),t="<table id=\""+_2d+"\"width=\""+_29+((_2a=="percent")?"%":"")+"\" border=\""+_2b+"\" cellspacing=\""+_2c+"\" cellpadding=\""+pad+"\">\n";for(var r=0;r<_27;r++){t+="\t<tr>\n";for(var c=0;c<_28;c++){t+="\t\t<td width=\""+(Math.floor(100/_28))+"%\">&nbsp;</td>\n";}t+="\t</tr>\n";}t+="</table>";this.onBuildTable({htmlText:t,id:_2d});this.hide();},onBuildTable:function $D8g_(_2e){}});dojo.provide("dojox.editor.plugins.EditorModifyTableDialog");dojo.require("dijit.ColorPalette");dojo.declare("dojox.editor.plugins.EditorModifyTableDialog",[dijit.Dialog],{baseClass:"EditorTableDialog",widgetsInTemplate:true,table:null,tableAtts:{},templateString:dojo.cache("dojox.editor.plugins","resources/modifyTable.html","<div class=\"dijitDialog\" tabindex=\"-1\" waiRole=\"dialog\" waiState=\"labelledby-${id}_title\">\r\n\t<div dojoAttachPoint=\"titleBar\" class=\"dijitDialogTitleBar\">\r\n\t<span dojoAttachPoint=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\">${modifyTableTitle}</span>\r\n\t<span dojoAttachPoint=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" dojoAttachEvent=\"onclick: onCancel\" title=\"${buttonCancel}\">\r\n\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\r\n\t</span>\r\n\t</div>\r\n    <div dojoAttachPoint=\"containerNode\" class=\"dijitDialogPaneContent\">\r\n        <table class=\"etdTable\">\r\n          <tr><td class=\"left\">\r\n                <span class=\"colorSwatchBtn\" dojoAttachPoint=\"backgroundCol\"></span>\r\n                <label>${backgroundColor}</label>\r\n            </td><td class=\"right\">\r\n                <span class=\"colorSwatchBtn\" dojoAttachPoint=\"borderCol\"></span>\r\n                <label>${borderColor}</label>\r\n            </td></tr><tr><td>\r\n                <span dojoAttachPoint=\"selectBorder\" dojoType=\"dijit.form.TextBox\" value=\"1\"></span>\r\n                <label>${borderThickness}</label>\r\n            </td><td>\r\n            ${pixels}\r\n            </td></tr><tr><td>\r\n                <select class=\"floatDijit\" dojoAttachPoint=\"selectAlign\" dojoType=\"dijit.form.FilteringSelect\">\r\n                  <option value=\"default\">${default}</option>\r\n                  <option value=\"left\">${left}</option>\r\n                  <option value=\"center\">${center}</option>\r\n                  <option value=\"right\">${right}</option>\r\n                </select>\r\n                <label>${align}</label>\r\n            </td><td></td></tr><tr><td>\r\n                <span dojoAttachPoint=\"selectWidth\" dojoType=\"dijit.form.TextBox\" value=\"100\"></span>\r\n                <label>${tableWidth}</label>\r\n            </td><td>\r\n                <select dojoAttachPoint=\"selectWidthType\" hasDownArrow=\"true\" dojoType=\"dijit.form.FilteringSelect\">\r\n                  <option value=\"percent\">${percent}</option>\r\n                  <option value=\"pixels\">${pixels}</option>\r\n                </select>\r\n                </td></tr><tr><td>\r\n                <span dojoAttachPoint=\"selectPad\" dojoType=\"dijit.form.TextBox\" value=\"0\"></span>\r\n                <label>${cellPadding}</label></td>\r\n            <td class=\"cellpad\"></td></tr><tr><td>\r\n                <span dojoAttachPoint=\"selectSpace\" dojoType=\"dijit.form.TextBox\" value=\"0\"></span>\r\n                <label>${cellSpacing}</label>\r\n            </td><td class=\"cellspace\"></td></tr>\r\n        </table>\r\n        <div class=\"dialogButtonContainer\">\r\n            <div dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick: onSet\">${buttonSet}</div>\r\n            <div dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick: onCancel\">${buttonCancel}</div>\r\n        </div>\r\n\t</div>\r\n</div>\r\n"),postMixInProperties:function $D8h_(){var _2f=dojo.i18n.getLocalization("dojox.editor.plugins","TableDialog",this.lang);dojo.mixin(this,_2f);this.inherited(arguments);},postCreate:function $D8i_(){dojo.addClass(this.domNode,this.baseClass);this.inherited(arguments);this.connect(this.borderCol,"click",function(){var div=document.createElement("div");var w=new dijit.ColorPalette({},div);dijit.popup.open({popup:w,around:this.borderCol});this.connect(w,"onChange",function(_30){dijit.popup.close(w);this.setBrdColor(_30);});});this.connect(this.backgroundCol,"click",function(){var div=document.createElement("div");var w=new dijit.ColorPalette({},div);dijit.popup.open({popup:w,around:this.backgroundCol});this.connect(w,"onChange",function(_31){dijit.popup.close(w);this.setBkColor(_31);});});this.setBrdColor(dojo.attr(this.table,"bordercolor"));this.setBkColor(dojo.attr(this.table,"bgcolor"));var w=dojo.attr(this.table,"width");var p="pixels";if(w.indexOf("%")>-1){p="percent";w=w.replace(/%/,"");}this.selectWidth.attr("value",w);this.selectWidthType.attr("value",p);this.selectBorder.attr("value",dojo.attr(this.table,"border"));this.selectPad.attr("value",dojo.attr(this.table,"cellpadding"));this.selectSpace.attr("value",dojo.attr(this.table,"cellspacing"));this.selectAlign.attr("value",dojo.attr(this.table,"align"));},setBrdColor:function $D8j_(_32){this.brdColor=_32;dojo.style(this.borderCol,"backgroundColor",_32);},setBkColor:function $D8k_(_33){this.bkColor=_33;dojo.style(this.backgroundCol,"backgroundColor",_33);},onSet:function $D8l_(){dojo.attr(this.table,"bordercolor",this.brdColor);dojo.attr(this.table,"bgcolor",this.bkColor);dojo.attr(this.table,"width",(this.selectWidth.attr("value")+((this.selectWidthType.attr("value")=="pixels")?"":"%")));dojo.attr(this.table,"border",this.selectBorder.attr("value"));dojo.attr(this.table,"cellpadding",this.selectPad.attr("value"));dojo.attr(this.table,"cellspacing",this.selectSpace.attr("value"));dojo.attr(this.table,"align",this.selectAlign.attr("value"));this.hide();},onSetTable:function $D8m_(_34){}});dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){if(o.plugin){return;}if(o.args&&o.args.command){var cmd=o.args.command.charAt(0).toLowerCase()+o.args.command.substring(1,o.args.command.length);switch(cmd){case "insertTableRowBefore":case "insertTableRowAfter":case "insertTableColumnBefore":case "insertTableColumnAfter":case "deleteTableRow":case "deleteTableColumn":case "colorTableCell":case "modifyTable":case "insertTable":case "tableContextMenu":o.plugin=new dojox.editor.plugins.TablePlugins({commandName:cmd});break;}}});}